<!DOCTYPE html>
<html lang="en" class="rw-text-font">
<head>
    <meta charset="utf-8"/>

    <script>
        (function() {
            let params = new URLSearchParams(window.location.search);
            let isModded = params.get('d') === 'modded';
            let suffix = isModded ? '-modded' : '';
            let baseUrl = '%PUBLIC_URL%';
            if (baseUrl.endsWith('/')) baseUrl = baseUrl.slice(0, -1);

            window.__RW_DATA_KEY__ = isModded ? 'modded' : 'vanilla';
            window.__RW_DATA__ = {
                pearls: fetch(baseUrl + '/data/parsed-dialogues' + suffix + '.json').then(function(r) {
                    if (!r.ok) throw new Error(r.statusText);
                    return r.json();
                }),
                source: fetch(baseUrl + '/data/source-decrypted' + suffix + '.json').then(function(r) {
                    if (!r.ok) throw new Error(r.statusText);
                    return r.json();
                })
            };
        })();
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="theme-color" content="#000000"/>
    <meta
            name="description"
            content="Explore and track all Pearls, Broadcasts, Downpour and The Watcher DLC content, Iterator dialogues, Echoes and more from the game Rain World in your browser. Full-text search, view interactive map locations and use the spoiler protection functionality."
    />
    <meta name="keywords"
          content="Rain World, Downpour DLC, Pearls, Broadcasts, Five Pebbles Pearls, White Pearls, Iterator Dialogue, Echoes, Lore Guide, Interactive Map, Game Collectibles, Spoiler Mode, Developer Commentary, Unlock Mode, Transcriber, Game Lore, The Watcher, Pearl Reader"/>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://yanwittmann.github.io/rw-collection-index"/>
    <meta property="og:title" content="Rain World Collection Index | Pearls, Broadcasts, Downpour & The Watcher DLC"/>
    <meta property="og:description"
          content="Complete interactive database of Rain World lore. Browse Pearls, Broadcasts, Dialogue, and more with search and spoiler protection."/>
    <meta property="og:image"
          content="https://raw.githubusercontent.com/YanWittmann/rw-collection-index/refs/heads/main/doc/rw-collection-index-card-2x.png"/>

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image"/>
    <meta property="twitter:url" content="https://yanwittmann.github.io/rw-collection-index"/>
    <meta property="twitter:title"
          content="Rain World Collection Index | Pearls, Broadcasts, Downpour & The Watcher DLC"/>
    <meta property="twitter:description"
          content="Complete interactive database of Rain World lore. Browse Pearls, Broadcasts, Dialogue, and more with search and spoiler protection."/>
    <meta property="twitter:image"
          content="https://raw.githubusercontent.com/YanWittmann/rw-collection-index/refs/heads/main/doc/rw-collection-index-card-2x.png"/>

    <!-- Canonical -->
    <link rel="canonical" href="https://yanwittmann.github.io/rw-collection-index"/>

    <link rel="icon" type="image/x-icon" href="%PUBLIC_URL%/favicon.ico?"/>
    <link rel="shortcut icon" type="image/x-icon" href="%PUBLIC_URL%/favicon.ico?"/>

    <link rel="icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-32x32.png" sizes="32x32"/>
    <link rel="shortcut icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-32x32.png" sizes="32x32"/>

    <link rel="icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-64x64.png" sizes="64x64"/>
    <link rel="shortcut icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-64x64.png" sizes="64x64"/>

    <link rel="icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-192x192.png" sizes="192x192"/>
    <link rel="shortcut icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-192x192.png" sizes="192x192"/>

    <link rel="icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-512x512.png" sizes="512x512"/>
    <link rel="shortcut icon" type="image/png" href="%PUBLIC_URL%/web-app-manifest-512x512.png" sizes="512x512"/>

    <link rel="icon" type="image/png" href="%PUBLIC_URL%/favicon-96x96.png" sizes="96x96"/>
    <link rel="shortcut icon" type="image/png" href="%PUBLIC_URL%/favicon-96x96.png" sizes="96x96"/>

    <link rel="icon" type="image/svg+xml" href="%PUBLIC_URL%/favicon.svg"/>
    <link rel="apple-touch-icon" sizes="180x180" href="%PUBLIC_URL%/apple-touch-icon.png"/>
    <link rel="manifest" href="%PUBLIC_URL%/site.webmanifest"/>

    <meta name="google-site-verification" content="a7U22jZ4G4iP3B_Ukped9W1814rnDme2P5MWF2OOCyk"/>

    <title>Rain World Lore Collection Index | Pearls, Broadcasts, Downpour & The Watcher DLC</title>

    <style>
        @font-face {
            font-family: 'Rodondo';
            src: url('%PUBLIC_URL%/font/Rodondo.woff2') format('woff2'), url('%PUBLIC_URL%/font/Rodondo.otf') format('opentype');
            size-adjust: 150%;
            font-display: swap;
        }

        @font-face {
            font-family: 'Segoe-UI-Semibold';
            src: url('%PUBLIC_URL%/font/Segoe-UI-Semibold-subset.woff2') format('woff2'), url('%PUBLIC_URL%/font/Segoe-UI-Semibold.ttf') format('truetype');
            size-adjust: 110%;
            font-display: swap;
        }

        html, body {
            background-color: #101010;
        }
    </style>

    <script>
        function updateCanonicalTag() {
            // remove existing canonical tag if present
            const existingCanonical = document.querySelector('link[rel="canonical"]');
            if (existingCanonical) {
                existingCanonical.remove();
            }

            const params = new URLSearchParams(window.location.search);
            let canonicalUrl = window.location.origin + window.location.pathname;

            // only include meaningful parameters in canonical URL
            const meaningfulParams = ['item'];
            const canonicalParams = {};
            for (const param of meaningfulParams) {
                if (params.has(param)) {
                    canonicalParams[param] = params.get(param);
                }
            }

            const canonicalSearchParams = new URLSearchParams();
            for (const [key, value] of Object.entries(canonicalParams)) {
                canonicalSearchParams.set(key, value);
            }

            if (canonicalSearchParams.toString()) {
                canonicalUrl += '?' + canonicalSearchParams.toString();
            }

            const canonicalLink = document.createElement('link');
            canonicalLink.rel = 'canonical';
            canonicalLink.href = canonicalUrl;
            document.head.appendChild(canonicalLink);
        }

        updateCanonicalTag();

        const originalPushState = history.pushState;
        const originalReplaceState = history.replaceState;

        history.pushState = function () {
            originalPushState.apply(history, arguments);
            updateCanonicalTag();
        };

        history.replaceState = function () {
            originalReplaceState.apply(history, arguments);
            updateCanonicalTag();
        };

        window.addEventListener('popstate', updateCanonicalTag);
    </script>
</head>
<body class="overflow-y-hidden">
<noscript>You need to enable JavaScript to view the pearls collection.</noscript>
<div id="root"></div>
</body>
<script>
    if (window.location.hostname !== 'localhost' && !window.location.hostname.startsWith('127.0.0')) {
        const lastAccessKey = 'lastAccessTime';

        const lastAccessTime = localStorage.getItem(lastAccessKey);
        const currentTime = Date.now();

        const keyToUse = lastAccessTime && (currentTime - lastAccessTime < 10 * 60 * 1000) ? 'access-iden' : 'access';

        localStorage.setItem(lastAccessKey, currentTime);

        setTimeout(() => {
            fetch(`https://yanwittmann.de/projects/countapi/increment.php?namespace=rwci&key=${keyToUse}`, { method: 'GET' })
                .catch(error => console.error('Error tracking page view:', error));
        }, 1000);
    }
</script>
</html>
