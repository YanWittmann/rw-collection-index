# Rain World Collection Index

<img alt="Rain World Collection Index Hero" src="doc/rw-collection-index-card-hero.png" width="1280"/>

The Rain World Collection Index is a comprehensive interactive archive created to help players explore and keep track of [Rain World's](https://store.steampowered.com/app/312520/Rain_World/) lore.
It provides a centralized place to browse all Pearls, Broadcasts, Dialogue and Projections from the Vanilla base game, Downpour DLC, The Watcher DLC and popular community mods.

ðŸ”— **Hosted at:** [https://yanwittmann.github.io/rw-collection-index](https://yanwittmann.github.io/rw-collection-index)

## Collection Index Content

The dataset spans the entire known history of the Ancients and Iterators.

<table>
  <thead>
    <tr>
      <th width="25%">Expansion / Source</th>
      <th width="75%">Content Details</th>
    </tr>
  </thead>
  <tbody>
    <!-- VANILLA -->
    <tr>
      <td align="center">
        <img src="site/public/img/vanilla-rw.png" width="80" style="image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;" /><br/>
        <b>Base Game</b>
      </td>
      <td>
        <ul>
          <li><img src="site/public/img/pearl.png" width="16" valign="middle"/> All transcriptions for Colored, White, and Five Pebbles pearls.</li>
          <li><img src="site/public/img/FP.png" width="16" valign="middle"/> Dialogue trees for Looks to the Moon and Five Pebbles.</li>
          <li><img src="site/public/img/echo.png" width="16" valign="middle"/> Dialogue for all Echoes.</li>
          <li><img src="site/public/img/item/Gooieduck_icon.png" width="16" valign="middle"/> All item descriptions.</li>
        </ul>
        <p>
          <img src="site/public/img/survivor.png" width="24" title="Survivor"/>
          <img src="site/public/img/monk.png" width="24" title="Monk"/>
          <img src="site/public/img/hunter.png" width="24" title="Hunter"/>
         &nbsp;'&nbsp;&nbsp;
          <img src="site/public/img/LttM-post-collapse.png" width="24" title="Looks to the Moon"/>
        </p>
      </td>
    </tr>
    <!-- DOWNPOUR -->
    <tr>
      <td align="center">
        <img src="site/public/img/dlc-dp.png" width="80" style="image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;" /><br/>
        <b>Downpour</b>
      </td>
      <td>
        <ul>
          <li><img src="site/public/img/pearl.png" width="16" valign="middle"/> All transcriptions for Colored, White, and Five Pebbles pearls.</li>
          <li><img src="site/public/img/broadcast.png" width="16" valign="middle"/> All intercepted logs and transmissions from <img src="site/public/img/spearmaster.png" width="16" valign="middle"/> Spearmaster's campaign.</li>
          <li><img src="site/public/img/FP-artificer.png" width="16" valign="middle"/> Campaign-specific iterator interactions.</li>
          <li><img src="site/public/img/broadcast.png" width="16" valign="middle"/> Full developer commentary.</li>
        </ul>
        <p>
          <img src="site/public/img/artificer.png" width="24" title="Artificer"/>
          <img src="site/public/img/gourmand.png" width="24" title="Gourmand"/>
          <img src="site/public/img/spearmaster.png" width="24" title="Spearmaster"/>
          <img src="site/public/img/rivulet.png" width="24" title="Rivulet"/>
          <img src="site/public/img/saint.png" width="24" title="Saint"/>
          <img src="site/public/img/inv.png" width="24" title="???"/>
         &nbsp;'&nbsp;&nbsp;
          <img src="site/public/img/FP-artificer.png" width="24" title="Five Pebbles"/>
          <img src="site/public/img/LttM-pre-collapse.png" width="24" title="Looks to the Moon (Pre-Collapse)"/>
        </p>
      </td>
    </tr>
    <!-- WATCHER -->
    <tr>
      <td align="center">
        <img src="site/public/img/dlc-watcher.png" style="image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;" width="80" /><br/>
        <b>The Watcher</b>
      </td>
      <td>
        <ul>
          <li><img src="site/public/img/PearlReader.png" width="16" valign="middle"/> Animated Pearl Reader Projections.</li>
          <li><img src="site/public/img/PearlReaderAudio.png" width="16" valign="middle"/> Pearl Reader Audio Files.</li>
          <li><img src="site/public/img/PearlReaderText.png" width="16" valign="middle"/> Pearl Reader Readings.</li>
          <li><img src="site/public/img/spinning-top.png" width="16" valign="middle"/> Spinning Top dialogue.</li>
          <li><img src="site/public/img/rot-prince-weaver.png" width="16" valign="middle"/> Rot Prince dialogue.</li>
          <li><img src="site/public/img/void-weaver.png" width="16" valign="middle"/> Void Weaver dialogue.</li>
        </ul>
        <p>
          <img src="site/public/img/watcher-ripple.png" width="24" title="The Watcher"/>
        </p>
      </td>
    </tr>
    <!-- MODDED -->
    <tr>
      <td align="center">
        <img src="site/public/img/modded/ChasingWind/thumb.webp" width="80" style="image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;" /><br/>
        <b>Community Mods</b>
      </td>
      <td>
        <ul>
          <li><img src="site/public/img/pearl.png" width="16" valign="middle"/> Lore and pearls found in popular region mods.</li>
          <li><img src="site/public/img/modded/nsh.png" width="16" valign="middle"/> Custom Iterator dialogue from community projects.</li>
        </ul>
        <p>
          <img src="site/public/img/modded/seer.png" width="24" title="Seer"/>
         &nbsp;'&nbsp;&nbsp;
          <img src="site/public/img/modded/chasing-wind.png" width="24" title="Chasing Wind"/>
          <img src="site/public/img/modded/nsh.png" width="24" title="Chasing Wind"/>
        </p>
        <p>
          Looking for a missing mod? Let me know, or <a href="#contributing">contribute</a> it yourself!
        </p>
      </td>
    </tr>
  </tbody>
</table>

## Features

<table>
  <tr>
    <td width="50%" valign="top" style="padding: 10px;">
      <strong><img src="site/public/img/lock.png" width="20" valign="middle"/> Spoiler Protection</strong>
      <p>Designed for first-time players. Toggle Unlock Mode to hide all text behind "?". Reveal hints progressively or verify your in-game findings manually without spoiling the rest of the collection.</p>
    </td>
    <td width="50%" valign="top" style="padding: 10px;">
      <strong><img src="site/public/img/filter.png" width="20" valign="middle"/> Search and Filter</strong>
      <p>Full-text search across the entire database. Filter results by Region, Speaker, Type or Tag. Hover over speaker names (e.g. LttM, NSH) to reveal their full canonical names and text color.</p>
    </td>
  </tr>
  <tr>
    <td valign="top" style="padding: 10px;">
      <strong><img src="site/public/img/pin.png" width="20" valign="middle"/> Interactive Map Links</strong>
      <p>Most entries are linked directly to the <a href="https://rain-world-map.github.io/">Rain World Interactive Map</a> or related maps. Click the pin icon to see exactly where a Pearl or Broadcast is located in the game world.</p>
    </td>
    <td valign="top" style="padding: 10px;">
      <strong><img src="site/public/img/share.png" width="20" valign="middle"/> Deep Linking</strong>
      <p>Share specific lore entries easily. The URL updates as you browse, storing the selected item and the specific transcriber.</p>
      <code>?item=SI_chat3</code> &nbsp; <code>?transcriber=LttM-pre-collapse</code>
    </td>
  </tr>
  <tr>
    <td valign="top" style="padding: 10px;">
      <strong><img src="site/public/img/source.png" width="20" valign="middle"/> Source Data View</strong>
      <p>Toggle "Source View" to see the original game file identifiers, internal IDs, and raw text strings and source code on selected entries alongside the formatted transcription.</p>
    </td>
    <td valign="top" style="padding: 10px;">
      <strong><img src="site/public/img/PearlReader.png" width="20" valign="middle"/> All Transcriptions</strong>
      <p>Switch between different Iterator readings and interpretations for the same pearl (e.g. Moon Pre-Collapse vs. Post-Collapse).</p>
    </td>
  </tr>
</table>

![UI Example of a selected Pearl](./doc/ui-demo-01.png)

## Installation and Setup

### Clone the Repository / Install Dependencies

```bash
git clone https://github.com/YanWittmann/rw-collection-index
cd rw-collection-index/site
npm install
```

### Run the Application

```bash
npm run start
```

### Build the Application

```bash
npm run build
```

## Data Preparation

If you feel like replicating the dataset yourself, well, here you go.

### Game Text extraction

To populate the application with the latest text, you need to extract the strings from the game files.

#### Method 1: Mod Extraction

1. Install and run the [Text Extractor Mod](https://steamcommunity.com/sharedfiles/filedetails/?id=2933241596) from the Steam Workshop. The mod will write the extracted files into the following directory:
   `Rain World/RainWorld_Data/StreamingAssets/decrypt`
2. In the `decrypt` directory, rename the language folders from `[lang]` to `text_[lang]` (e.g. `Eng` becomes `text_eng`).
3. Certain hard-coded strings have been extracted from `Rain World/RainWorld_Data/Managed/Assembly-CSharp.dll` using [dnSpy](https://github.com/dnSpy/dnSpy). These files are already included in this repository at `[dialogue/source/dll](dialogue/source/dll)`. Copy this `dll` directory into your `decrypt` folder alongside the `text_...` folders.
4. Run the main decryption script inside your `.../StreamingAssets/decrypt` folder: `python path/to/repo/site/build-scripts/decrypt-rw-text.py`.  
   This will process all text files and the `dll` sources into a single JSON file.
5. Move the resulting `decrypted.json` file to the [dialogue/source](dialogue/source) directory in this repository.

<details>
<summary><b>Method 2: Old Python Script (Deprecated)</b></summary>

> :warning: This method does not work on broadcasts and is therefore deprecated.

We need to extract the strings from Rain World to use them in the application.
Copy the following python program [decrypt-rw-text.py](site/build-scripts/decrypt-rw-text.py) into your
`SteamLibrary\steamapps\common\Rain World` folder and run it.
This will create a folder `decrypted` with all the source files in them and a `decrypted.json` file with all the
english variants of the strings.

Copy the `decrypted.json` file into the [source](dialogue/source) folder.

</details>

Note:
There is also a custom script available for decoding entire directories of files, with special case handling in case the file was renamed and the salt for the hash differs from the expected one: [decrypt-entry.py](site/build-scripts/decrypt-entry.py).
It sometimes fails, however; its success rate is roughly 98%, so for the rest we have to fallback on the decryption mod.

## Contributing

Contributions are welcome! Please open an Issue or Pull Request to discuss changes.  
View [how-to-dialogue.md](doc/how-to-dialogue.md) to learn how to contribute your own dialogue or modify existing ones.

Do you want your modded dialogue to be added to the [modded version of the collection](https://yanwittmann.github.io/rw-collection-index/?d=modded)?
Please let me know, or follow the guide above to add it by yourself!

| User                      | Contributions                                                                                                            |
|---------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Space Dwarf               | "Colored Pearls + Broadcasts" category rename; DLC Tag for DLC content; Some incorrect map locations.                    |
| bug leaving room          | Use up-to-date interactive map links; Info that certain text color only exists in DP; Show Pearl's internal identifiers. |
| Hmoorkin                  | Broadcast icons are too similar in color.                                                                                |
| yukithedestroyer          | If there are multiple identical transcribers on an entry, they do not unlock correctly in spoiler mode.                  |
| candlesign.4539 / skyball | Keyboard navigation.                                                                                                     |
| scir                      | Created new Icon set.                                                                                                    |
| ShockMicro                | Some DP items were not marked as such.                                                                                   |
| candlesign.4539           | Buttons get stuck in the hovered state; replaced framer-motion native logic with custom hover logic.                     |
| capwolfbane / SUNFISH     | Incorrectly "vanilla" tagged elements.                                                                                   |
| capwolfbane               | Merge "FP" and "Five Pebbles" filter entries.                                                                            |
| erickckk                  | Correct TEXT_KITESDAY map location link.                                                                                 |
| artustan                  | #6 remove `BroadcastMisc` entry from `Spearmasterpearl`.                                                                 |

Feel like you should be on this list? Let me know!

---

Code on <a href="https://github.com/YanWittmann/rw-collection-index" target="_blank">GitHub</a>&nbsp;&nbsp;â—‹&nbsp;&nbsp;Created by Yan Wittmann&nbsp;&nbsp;â—‹&nbsp;&nbsp;Rain World is property of <a href="https://videocultmedia.com" target="_blank">Videocult</a>&nbsp;&nbsp;â—‹&nbsp;&nbsp;<a href="https://github.com/YanWittmann/rw-collection-index/blob/main/privacy.md" target="_blank">Privacy Policy</a></div>
